<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caro Game</title> 
</head>
<link rel="stylesheet" href="caro_style.css">
<body>
    <fieldset class = "form-group1">
        <legend><b>ðŸŽ® Caro Game</b></legend>
        <span> Columns: </span>
        <input id="columnInput" name="keyword" type="number" placeholder="Enter column" value="20">
        <span> Rows: </span>
        <input id="rowInput" name="keyword" type="number" placeholder="Enter row" value="20">
        <br>
        <button type="button" class="start" onclick="startGame()">ðŸ†• Start/Reset Game</button>
        <button type="button" class="score" onclick="removeScore()">ðŸ”¢ Remove Score</button>
    </fieldset>
    <br>

    <div class="game-area">
        <div class = "form-group2">
            <p>Your player turn</p>
            <p id="playerTurnInfo">X</p>
        </div>
        <div class="score-board">
            <h3 style="color: #00dbde; margin-bottom: 15px; text-align: center;">SCORE</h3>
            <div class="score-row score-x">
                <div>
                    <div style="color: #00dbde; font-size: 14px;">NGÆ¯á»œI CHÆ I X</div>
                    <div class="score-value" id="scoreX">0</div>
                </div>
                    <div style="color: #00dbde; font-size: 32px;">âœ–</div>
            </div>
                    
            <div class="score-row score-o">
                <div>
                    <div style="color: #f5576c; font-size: 14px;">NGÆ¯á»œI CHÆ I O</div>
                    <div class="score-value" id="scoreO">0</div>
                </div>
                <div style="color: #f5576c; font-size: 32px;">â­•</div>
            </div>
        </div>
        <div class = "form-group3">
            <p>Click to empty cell to play!</p>
            <div id="board"></div>                
            <p id="result"></p>
        </div>
    </div>

<script>
class GameBoard {
    constructor(width, height) {
        this.width = width;
        this.height = height;
        this.board = [];
        this.currentPlayer = "X";
        this.createBoard();
        this.gameOver = false;
    }

    createBoard() {
        for (let i = 0; i < this.width; i++) {
            this.board[i] = [];
            for (let j = 0; j < this.height; j++) {
                this.board[i][j] = "";
            }
        }
        this.displayBoard();
    }

    displayBoard() {
        let table = '<table border="1">';
        for (let i = 0; i < this.width; i++) {
            table += "<tr>";
            for (let j = 0; j < this.height; j++) {

                let color = "";
                if (this.board[i][j] === "X") color = "#3498db";
                if (this.board[i][j] === "O") color = "#e74c3c";

                table += `
                    <td onclick="game.handleClick(${i}, ${j})"
                        style="width:25px;height:25px;
                               text-align:center;
                               cursor:pointer;
                               font-weight:bold;
                               color:${color}">
                        ${this.board[i][j]}
                    </td>`;
            }
            table += "</tr>";
        }
        table += "</table>";
        document.getElementById("board").innerHTML = table;
    }

    handleClick(i, j) {
        if (this.gameOver) return;
        if (this.board[i][j] !== "") return;

        this.board[i][j] = this.currentPlayer;

        for (let i=0; i<this.width; i++){
                for (let j=0; j<this.height; j++){
                    if (this.board[i][j] == "") continue;
                    if (
                        ((this.board[i][j]==this.board[i+1][j])&&(this.board[i][j]==this.board[i+2][j])&&(this.board[i][j]==this.board[i+3][j])&&(this.board[i][j]==this.board[i+4][j])) ||
                        ((this.board[i][j]==this.board[i][j+1])&&(this.board[i][j]==this.board[i][j+2])&&(this.board[i][j]==this.board[i][j+3])&&(this.board[i][j]==this.board[i][j+4])) ||
                        ((this.board[i][j]==this.board[i+1][j+1])&&(this.board[i][j]==this.board[i+2][j+2])&&(this.board[i][j]==this.board[i+3][j+3])&&(this.board[i][j]==this.board[i+4][j+4])) ||
                        ((this.board[i][j]==this.board[i-1][j+1])&&(this.board[i][j]==this.board[i-2][j+2])&&(this.board[i][j]==this.board[i-3][j+3])&&(this.board[i][j]==this.board[i-4][j+4]))
                    ) {
                        this.displayBoard();
                        document.getElementById("result").innerText = this.currentPlayer + " win! ðŸŽ‰";
                        this.gameOver = true;
                        if (this.currentPlayer === "X") {
                            let scoreX = parseInt(document.getElementById("scoreX").innerText);
                            document.getElementById("scoreX").innerText = scoreX + 1;
                        } else {
                            let scoreO = parseInt(document.getElementById("scoreO").innerText);
                            document.getElementById("scoreO").innerText = scoreO + 1;
                        }
                        return;
                    }
                }
            }

        if (this.currentPlayer === "X") {
            this.currentPlayer = "O";
        } else {
            this.currentPlayer = "X";
        }
        document.getElementById('playerTurnInfo').textContent = this.currentPlayer;
        this.displayBoard();
    }
}

function startGame() {
    let columns = parseInt(document.getElementById("columnInput").value);
    let rows = parseInt(document.getElementById("rowInput").value);
    game = new GameBoard(columns, rows);
}

startGame();
</script>
</body>
</html>